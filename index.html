<!-- <!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>æ‰‹å‹¢ç–Šæ–¹å¡Š AR</title>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; background-color: #222; font-family: sans-serif; }
        canvas { display: block; width: 100vw; height: 100vh; transform: scaleX(-1); /* é¡åƒç¿»è½‰ */ }
        #ui-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; display: flex; justify-content: center; align-items: flex-start;
        }
        #score-board {
            margin-top: 20px; color: white; font-size: 24px; font-weight: bold; 
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5); z-index: 10;
        }
        #video-feed { display: none; } /* éš±è—åŸå§‹å½±ç‰‡ï¼Œåªé¡¯ç¤º Canvas */
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
</head>
<body>

    <div id="ui-layer">
        <div id="score-board">é«˜åº¦: 0 | ç‹€æ…‹: è«‹æåˆæ‰‹æŒ‡</div>
    </div>
    <video id="video-feed" playsinline></video>
    <canvas id="output-canvas"></canvas>

<script>
    const videoElement = document.getElementById('video-feed');
    const canvasElement = document.getElementById('output-canvas');
    const canvasCtx = canvasElement.getContext('2d');
    const scoreBoard = document.getElementById('score-board');

    // éŠæˆ²ç‹€æ…‹è®Šæ•¸
    let pinchStartTime = 0;
    let isPinching = false;
    let currentBlock = null;
    let staticBlocks = []; // å·²ç¶“ç–Šå¥½çš„æ–¹å¡Š
    const PINCH_THRESHOLD = 0.05; // æåˆè·é›¢é–¾å€¼
    const LOAD_TIME = 1500; // 1.5ç§’
    const BLOCK_SIZE = 80;
    let score = 0;
    
    // æ‰‹æŒ‡åº§æ¨™
    let thumbTip = {x: 0, y: 0};
    let indexTip = {x: 0, y: 0};
    let pinchCenter = {x: 0, y: 0};

    // åˆå§‹åŒ– Canvas å¤§å°
    function resizeCanvas() {
        canvasElement.width = window.innerWidth;
        canvasElement.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // MediaPipe Hands è¨­å®š
    const hands = new Hands({locateFile: (file) => {
        return `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`;
    }});

    hands.setOptions({
        maxNumHands: 1,
        modelComplexity: 1,
        minDetectionConfidence: 0.7,
        minTrackingConfidence: 0.7
    });

    hands.onResults(onResults);

    // å•Ÿå‹•ç›¸æ©Ÿ
    const camera = new Camera(videoElement, {
        onFrame: async () => {
            await hands.send({image: videoElement});
        },
        width: 1280,
        height: 720
    });
    camera.start();

    // æ ¸å¿ƒé‚è¼¯ Loop
    function onResults(results) {
        // æ¸…é™¤ç•«å¸ƒ
        canvasCtx.clearRect(0, 0, canvasElement.width, canvasElement.height);
        
        // ç¹ªè£½ç›¸æ©Ÿç•«é¢ (èƒŒæ™¯)
        canvasCtx.save();
        canvasCtx.drawImage(results.image, 0, 0, canvasElement.width, canvasElement.height);
        
        // è™•ç†æ–¹å¡Šé‚è¼¯ (åŒ…å«æ‰è½å‹•ç•«)
        updateGamePhysics();
        drawBlocks();

        if (results.multiHandLandmarks && results.multiHandLandmarks.length > 0) {
            const landmarks = results.multiHandLandmarks[0];
            
            // å–å¾—å¤§æ‹‡æŒ‡ (4) å’Œé£ŸæŒ‡ (8) çš„åº§æ¨™
            // MediaPipe åº§æ¨™æ˜¯ 0-1 çš„æ¯”ä¾‹ï¼Œéœ€è½‰æ›æˆ Canvas åƒç´ 
            thumbTip = { x: landmarks[4].x * canvasElement.width, y: landmarks[4].y * canvasElement.height };
            indexTip = { x: landmarks[8].x * canvasElement.width, y: landmarks[8].y * canvasElement.height };
            
            // è¨ˆç®—æåˆä¸­å¿ƒé»
            pinchCenter = {
                x: (thumbTip.x + indexTip.x) / 2,
                y: (thumbTip.y + indexTip.y) / 2
            };

            // ç¹ªè£½æ‰‹æŒ‡é—œéµé» (è¦–è¦ºè¼”åŠ©)
            drawHandPoints(thumbTip, indexTip);

            // è¨ˆç®—è·é›¢ (æ­å¹¾é‡Œå¾—è·é›¢)
            // å› ç‚º canvas å¯¬é«˜ä¸åŒï¼Œé€™è£¡ç°¡åŒ–ä½¿ç”¨æ¨™æº–åŒ–åº§æ¨™è¨ˆç®—è·é›¢æœƒæ¯”è¼ƒæº–ç¢º
            const dist = Math.hypot(landmarks[4].x - landmarks[8].x, landmarks[4].y - landmarks[8].y);

            // åˆ¤æ–·æåˆ
            if (dist < PINCH_THRESHOLD) {
                if (!isPinching) {
                    isPinching = true;
                    pinchStartTime = Date.now();
                }
                handlePinchHold();
            } else {
                if (isPinching) {
                    handleRelease();
                }
                isPinching = false;
                pinchStartTime = 0;
            }
        }
        canvasCtx.restore();
    }

    // ç¹ªè£½æ‰‹æŒ‡é»
    function drawHandPoints(p1, p2) {
        canvasCtx.fillStyle = '#00FF00';
        canvasCtx.beginPath(); arc(p1.x, p1.y, 5); canvasCtx.fill();
        canvasCtx.beginPath(); arc(p2.x, p2.y, 5); canvasCtx.fill();
    }
    
    function arc(x, y, r) {
        canvasCtx.arc(x, y, r, 0, 2 * Math.PI);
    }

    // è™•ç†æåˆæŒçºŒç‹€æ…‹
    function handlePinchHold() {
        const elapsed = Date.now() - pinchStartTime;
        const progress = Math.min(elapsed / LOAD_TIME, 1);

        // å¦‚æœé‚„æ²’ç”Ÿæˆæ–¹å¡Šï¼Œé¡¯ç¤ºé€²åº¦æ¢
        if (!currentBlock) {
            scoreBoard.innerText = "ç”Ÿæˆä¸­...";
            // ç•«åœˆåœˆé€²åº¦æ¢
            canvasCtx.strokeStyle = 'white';
            canvasCtx.lineWidth = 5;
            canvasCtx.beginPath();
            canvasCtx.arc(pinchCenter.x, pinchCenter.y, 30, -Math.PI/2, (-Math.PI/2) + (Math.PI * 2 * progress));
            canvasCtx.stroke();

            // æ™‚é–“åˆ°ï¼Œç”Ÿæˆæ–¹å¡Š
            if (progress >= 1) {
                currentBlock = {
                    x: pinchCenter.x,
                    y: pinchCenter.y,
                    width: BLOCK_SIZE,
                    height: BLOCK_SIZE,
                    color: `hsl(${Math.random() * 360}, 70%, 50%)`,
                    isFalling: false
                };
                scoreBoard.innerText = "æ–¹å¡Šå·²æŠ“å–ï¼ç§»å‹•åˆ°åˆé©ä½ç½®é¬†é–‹";
            }
        } else {
            // æ–¹å¡Šå·²ç”Ÿæˆï¼Œè·Ÿéš¨æ‰‹æŒ‡ç§»å‹•
            currentBlock.x = pinchCenter.x - (BLOCK_SIZE / 2); // ç½®ä¸­
            currentBlock.y = pinchCenter.y - (BLOCK_SIZE / 2);
        }
    }

    // è™•ç†æ”¾é–‹æ‰‹æŒ‡
    function handleRelease() {
        if (currentBlock) {
            currentBlock.isFalling = true;
            scoreBoard.innerText = "è½ä¸‹ï¼";
            // é€™è£¡ä¸å°‡ currentBlock è¨­ç‚º nullï¼Œè€Œæ˜¯è®“å®ƒé€²å…¥ falling ç‹€æ…‹
            // ç­‰è½åœ°å¾Œå†ç”± updateGamePhysics è™•ç†
        } else {
             scoreBoard.innerText = "è«‹æåˆæ‰‹æŒ‡";
        }
    }

    // ç‰©ç†èˆ‡ç¹ªåœ–
    function updateGamePhysics() {
        // 1. è™•ç†æ­£åœ¨è½ä¸‹çš„æ–¹å¡Š (Current Block Falling)
        if (currentBlock && currentBlock.isFalling) {
            const fallSpeed = 15;
            currentBlock.y += fallSpeed;

            // æª¢æŸ¥ç¢°æ’åœ°é¢æˆ–ä¸‹ä¸€å€‹æ–¹å¡Š
            let landedY = canvasElement.height - 20; // åœ°é¢ä½ç½®
            
            // ç°¡å–®çš„å †ç–Šé‚è¼¯ï¼šæª¢æŸ¥æ˜¯å¦æ’åˆ° staticBlocks ä¸­æœ€é«˜çš„é‚£å€‹
            if (staticBlocks.length > 0) {
                const topBlock = staticBlocks[staticBlocks.length - 1];
                // å¦‚æœåœ¨ä¸‹æ–¹å¡Šçš„æ°´å¹³ç¯„åœå…§
                if (currentBlock.x + currentBlock.width > topBlock.x && 
                    currentBlock.x < topBlock.x + topBlock.width) {
                    landedY = topBlock.y;
                }
            }

            // è‘—åœ°åˆ¤æ–·
            if (currentBlock.y + currentBlock.height >= landedY) {
                currentBlock.y = landedY - currentBlock.height;
                currentBlock.isFalling = false;
                staticBlocks.push(currentBlock); // åŠ å…¥éœæ…‹å †ç–Š
                currentBlock = null; // é‡ç½®ç•¶å‰æ–¹å¡Š
                score++;
                scoreBoard.innerText = `é«˜åº¦: ${score} | è«‹å†æ¬¡æåˆ`;
            }
            
            // å¦‚æœæ‰å‡ºç•«é¢ (æ²’ç–Šåˆ°)
            if (currentBlock && currentBlock.y > canvasElement.height) {
                scoreBoard.innerText = "æ–¹å¡Šæ‰è½ï¼éŠæˆ²çµæŸ (é‡æ–°æ•´ç†é‡ä¾†)";
                currentBlock = null;
                // ç°¡å–®é‡ç½®
                setTimeout(() => { staticBlocks = []; score = 0; }, 2000);
            }
        }
    }

    function drawBlocks() {
        // ç•«éœæ…‹æ–¹å¡Š
        staticBlocks.forEach(b => drawRect(b));
        // ç•«ç•¶å‰æ‰‹ä¸Šçš„/è½ä¸‹çš„æ–¹å¡Š
        if (currentBlock) drawRect(currentBlock);
        
        // ç•«åœ°æ¿
        canvasCtx.fillStyle = '#555';
        canvasCtx.fillRect(0, canvasElement.height - 20, canvasElement.width, 20);
    }

    function drawRect(b) {
        canvasCtx.fillStyle = b.color;
        canvasCtx.strokeStyle = 'white';
        canvasCtx.lineWidth = 2;
        canvasCtx.fillRect(b.x, b.y, b.width, b.height);
        canvasCtx.strokeRect(b.x, b.y, b.width, b.height);
    }

</script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cool AR Lab</title>
    <style>
        body {
            background-color: #121212;
            color: white;
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        h1 { margin-bottom: 40px; text-transform: uppercase; letter-spacing: 2px; }
        
        .menu-btn {
            background: linear-gradient(45deg, #ff00cc, #3333ff);
            border: none;
            color: white;
            padding: 15px 30px;
            margin: 15px;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            width: 80%;
            max-width: 300px;
            text-align: center;
            text-decoration: none;
            box-shadow: 0 4px 15px rgba(255, 0, 204, 0.3);
            transition: transform 0.2s;
        }
        .menu-btn:active { transform: scale(0.95); }
        
        .footer { margin-top: 50px; color: #666; font-size: 12px; }
    </style>
</head>
<body>

    <h1>ğŸš€ å¯¦é©—å®¤å…¥å£</h1>

    <a href="/hand-game/" class="menu-btn">ğŸ“¦ æ‰‹å‹¢ç–Šæ–¹å¡Š</a>
    <a href="#" class="menu-btn" style="background: #333; color: #888;">ğŸš§ é–‹ç™¼ä¸­å°ˆæ¡ˆ...</a>

    <div class="footer">Â© 2026 Kevin's AR Lab</div>

</body>
</html>
